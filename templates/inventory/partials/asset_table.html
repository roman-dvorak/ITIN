<div class="rounded-lg border border-slate-200 bg-white">
  <div>
    <table class="min-w-full divide-y divide-slate-200 text-xs">
    <thead class="bg-slate-50">
      <tr>
        <th class="px-3 py-1.5 text-left font-medium text-slate-600">Hostname</th>
        <th class="px-3 py-1.5 text-left font-medium text-slate-600">Type</th>
        <th class="px-3 py-1.5 text-left font-medium text-slate-600">Owner</th>
        <th class="px-3 py-1.5 text-left font-medium text-slate-600">Status</th>
        <th class="px-3 py-1.5 text-left font-medium text-slate-600">Activity</th>
        <th class="px-3 py-1.5 text-left font-medium text-slate-600">OS</th>
        <th class="px-3 py-1.5 text-left font-medium text-slate-600">MAC</th>
        <th class="px-3 py-1.5 text-left font-medium text-slate-600">Groups</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-slate-200">
      {% for asset in assets %}
        <tr>
          <td class="px-3 py-1.5">
            <div class="flex items-center gap-1.5">
              <div class="group relative">
                <a href="{% url 'inventory:asset-detail' asset.id %}" class="font-medium text-slate-900 hover:text-blue-700">
                  {{ asset.name|default:"(no hostname)" }}
                </a>
                <div class="pointer-events-none invisible absolute left-0 top-full z-20 mt-1 w-72 rounded border border-slate-200 bg-white p-2 text-xs text-slate-700 shadow group-hover:visible">
                  <p class="font-semibold text-slate-900">{{ asset.name|default:"(no hostname)" }}</p>
                  <p>Type: {{ asset.get_asset_type_display }}</p>
                  <p>Status: {{ asset.get_status_display }}</p>
                  <p>Owner: {% if asset.owner %}{{ asset.owner.email }}{% else %}Unassigned{% endif %}</p>
                  <p>Manufacturer/Model: {{ asset.manufacturer|default:"-" }} / {{ asset.model|default:"-" }}</p>
                  <p>Serial: {{ asset.serial_number|default:"-" }}</p>
                  <p>Tag: {{ asset.asset_tag|default:"-" }}</p>
                </div>
              </div>
              <div class="group relative">
                <span class="inline-flex h-4 w-4 cursor-help items-center justify-center rounded-full border border-slate-300 bg-white text-[10px] font-semibold text-slate-600">i</span>
                <div class="pointer-events-none invisible absolute left-0 top-full z-20 mt-1 w-80 rounded border border-slate-200 bg-white p-2 text-xs text-slate-700 shadow group-hover:visible">
                  {% if asset.notes %}
                    {{ asset.notes|truncatechars:220 }}
                  {% else %}
                    <span class="text-slate-500">No description.</span>
                  {% endif %}
                </div>
              </div>
              {% for tag in asset.tags.all %}
                <span class="inline-block rounded bg-blue-100 px-1.5 py-0.5 text-[11px] text-blue-800">{{ tag.name }}</span>
              {% endfor %}
            </div>
            {% if asset.notes %}
              <p class="mt-0.5 max-w-[200px] text-[11px] leading-tight text-slate-500" style="display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;">{{ asset.notes|truncatechars:120 }}</p>
            {% endif %}
          </td>
          <td class="px-3 py-1.5">
            <div>{{ asset.get_asset_type_display }}</div>
            {% if asset.serial_number or asset.asset_tag %}
              <div class="mt-0.5 text-[10px] leading-tight text-slate-500">
                {% if asset.serial_number %}S/N: {{ asset.serial_number }}{% endif %}
                {% if asset.serial_number and asset.asset_tag %}<br>{% endif %}
                {% if asset.asset_tag %}Tag: {{ asset.asset_tag }}{% endif %}
              </div>
            {% endif %}
          </td>
          <td class="px-3 py-1.5">
            {% if asset.owner %}
              <a href="{% url 'inventory:user-detail' asset.owner.id %}" class="hover:text-blue-700">
              {% if asset.owner.first_name or asset.owner.last_name %}
                {{ asset.owner.first_name }} {{ asset.owner.last_name }}
              {% else %}
                {{ asset.owner.email }}
              {% endif %}
              </a>
            {% else %}
              <span class="text-slate-500">Unassigned</span>
            {% endif %}
            {% if asset.location %}
              <div class="mt-0.5 text-[10px] leading-tight text-slate-500">{{ asset.location.path_label }}</div>
            {% endif %}
          </td>
          <td class="px-3 py-1.5">
            <div class="flex items-center gap-1.5">
              <span>{{ asset.get_status_display }}</span>
              {% if asset.lifecycle_dashoffset is not None %}
                <div class="relative inline-block" title="Lifecycle: {{ asset.lifecycle_percentage }}%">
                  <svg width="20" height="20" viewBox="0 0 20 20" class="inline-block">
                    <circle cx="10" cy="10" r="8" fill="none" stroke="#e5e7eb" stroke-width="2"/>
                    <circle
                      cx="10" cy="10" r="8" fill="none"
                      stroke="{{ asset.lifecycle_color }}"
                      stroke-width="2"
                      stroke-dasharray="50.27"
                      stroke-dashoffset="{{ asset.lifecycle_dashoffset }}"
                      transform="rotate(-90 10 10)"
                    />
                  </svg>
                </div>
              {% else %}
                <div class="relative inline-block" title="Lifecycle unknown">
                  <svg width="20" height="20" viewBox="0 0 20 20" class="inline-block">
                    <circle cx="10" cy="10" r="8" fill="none" stroke="#e5e7eb" stroke-width="2"/>
                    <text x="10" y="14" text-anchor="middle" font-size="11" fill="#9ca3af">?</text>
                  </svg>
                </div>
              {% endif %}
              {% if asset.os_unsupported %}
                <i data-lucide="alert-circle" class="inline-block" style="width: 16px; height: 16px; color: #ef4444;" title="Unsupported OS"></i>
              {% endif %}
              {% if asset.approval_status_display == 'APPROVED' %}
                <i data-lucide="shield-check" class="inline-block" style="width: 16px; height: 16px; color: #10b981;" title="Network approved"></i>
              {% elif asset.approval_status_display == 'PENDING' %}
                <i data-lucide="shield-question" class="inline-block" style="width: 16px; height: 16px; color: #f59e0b;" title="Approval pending"></i>
              {% elif asset.approval_status_display == 'REJECTED' %}
                <i data-lucide="shield-x" class="inline-block" style="width: 16px; height: 16px; color: #ef4444;" title="Approval rejected"></i>
              {% elif asset.approval_status_display == 'REVOKED' %}
                <i data-lucide="shield-off" class="inline-block" style="width: 16px; height: 16px; color: #64748b;" title="Approval revoked"></i>
              {% endif %}
            </div>
          </td>
          <td class="px-3 py-1.5">
            <span class="inline-block rounded px-2 py-0.5 text-[11px] font-medium" style="background-color: {{ asset.activity_color }}1a; color: {{ asset.activity_color }};">{{ asset.activity_status }}</span>
          </td>
          <td class="px-3 py-1.5">
            {% if asset.os_display %}
              {{ asset.os_display }}
            {% else %}
              <span class="text-slate-400">Not set</span>
            {% endif %}
          </td>
          <td class="px-3 py-1.5">
            <div class="flex flex-wrap items-center gap-1">
              {% for mac in asset.mac_preview %}
                <span class="rounded bg-slate-100 px-1.5 py-0.5 font-medium text-slate-700">{{ mac }}</span>
              {% endfor %}
              {% if asset.mac_extra_count %}
                <span class="rounded bg-slate-200 px-1.5 py-0.5 font-medium text-slate-700">+{{ asset.mac_extra_count }}</span>
              {% endif %}
              {% if not asset.mac_preview and not asset.mac_extra_count %}
                <span class="text-slate-400">No MAC</span>
              {% endif %}
            </div>
            <p class="mt-0.5 text-[11px] text-slate-500">{{ asset.interfaces.all|length }} iface</p>
          </td>
          <td class="px-3 py-1.5">
            {% for group in asset.groups.all %}
              <span class="mb-0.5 inline-block rounded bg-slate-100 px-1.5 py-0.5 text-[11px] text-slate-700">{{ group.name }}</span>
            {% empty %}
              <span class="text-slate-400">No groups</span>
            {% endfor %}
          </td>
        </tr>
      {% empty %}
        <tr>
          <td class="px-3 py-2 text-slate-500" colspan="8">No assets available.</td>
        </tr>
      {% endfor %}
    </tbody>
    </table>
  </div>
</div>
